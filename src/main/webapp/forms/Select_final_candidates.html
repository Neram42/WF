<!DOCTYPE html>
<html>
<head>
<h1 style="color: rgb(179,0,0)">WBIG</h1>
<h2>Select final candidates</h2>
</head>
<body>


<form role="form" name="form" class="form-horizontal">

  <script cam-script type="text/form-script">

				camForm.on('form-loaded', function() {
  					camForm.variableManager.fetchVariable('cvs');
				});

				camForm.on('variables-fetched', function() {
  					$scope.cvs = camForm.variableManager.variableValue('cvs');
				});

				 camForm.on('submit', function(evt) {
    				// set value in variable manager so that it can be sent to backend
					camForm.variableManager.variableValue('cvs', $scope.cvs);
				
    				//camForm.variableManager.variableManager.variableValue('cv', $scope.cv);
					
					var selectedCV = $scope.cv;
					
					//camForm.variableManager.createVariable({
        			//	name: 'cv',
        			//	type: 'Object',
        			//	value: selectedCV,
        			//	isDirty: false
     				// });
					var cvData = $scope.cv;
					camForm.variableManager.createVariable({
        				name: 'cv',
        				type: 'Object',
        				value: cvData,
        				valueInfo: {
         					 // indicate that object is serialized as json
         					 serializationDataFormat: 'application/json',
         					 // provide classname of java object
          					objectTypeName: 'org.camunda.wf.hiring.entities.CV'
        				}
     				 });

 				 });

				

$scope.deleteElement = function(index){
    $scope.cvs.splice(index,1);
}

$scope.acceptElement = function(index, singlecv){
    $scope.cv = singlecv;
	$scope.disableAccept = true;
	$scope.cvs.splice(index,1);
}

			</script>		

			<table class="table">
            <thead>
            <tr>
				<th>Name</th>
				<th>Rating</th>
				<th>Decision</th>
				</tr>
			</thead>
			<tbody>
			
			<tr ng-repeat="singlecv in cvs">
				<td>{{singlecv.name}}</td>
				<td>{{singlecv.rating}}</td>
				<td><input type="button" class="btn btn-success" value="Accept" ng-click="acceptElement($index, singlecv)" ng-disabled="disableAccept"> <input type="button" class="btn btn-error" value="Decline" ng-click="deleteElement($index)"></td>
			</tr>
			</tbody>
			</table>
			
			
</form>
</body>
</html>